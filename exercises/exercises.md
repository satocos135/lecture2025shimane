2022年島根大学人間科学部「応用心理学Ⅰ」データ収集後探索的解析 資料
# R bootcamp: Exercises

<div style="text-align:right;">
2022.06.13<br>
佐藤浩輔
</div>

### Ex.1 ファイル操作の基本

1. デスクトップ上に新しいフォルダを作成しなさい。フォルダ名は`応用心理学2022`とすること
1. コマンドプロンプトを起動し、cdコマンドでカレントフォルダを確認しなさい
    + ヒント：「ファイル名を指名して実行」(`Win+R`)で`cmd`と入力
1. cdコマンドを使って、(1)で作ったフォルダに移動しなさい
    + ヒント：フォルダを右クリック→プロパティから、親フォルダの場所を確認できる
1. cdコマンドを使って、親フォルダに移動しなさい

### Ex.2 RStudio

1. RStudioから新規Rスクリプトを作成しなさい
    + ヒント： File > New File > R Script
1. (1)で作ったRスクリプトをEx.1で作ったフォルダに保存しなさい。ファイル名は`r_bootcamp.r`とすること
1. 一度RStudio上でファイルを閉じ、(2)で作ったファイルを開き直しなさい
1. エディタ上でRスクリプトに`print('hello')`と入力し、実行しなさい
    + ヒント：実行したい部分を選択して`Ctrl(command) + Enter`でスクリプトを実行できる


### Ex.3 はじめに覚えておくこと

1. コンソールに`# print('comment')`と入力して実行し、実行結果が __出ない__ ことを確認しなさい
1. エディタ上で`?mean`と入力して実行し、ヘルプが表示されることを確認しなさい
1. `getwd()`を実行して作業ディレクトリを確認しなさい
1. setwd()関数を使ってEx.1-1で作ったフォルダを作業ディレクトリに設定しなさい
1. 以下を順に実行しなさい
    1. `test = 1`
    1. `print(test)`
    1. `print(TEST)` (エラーが出ることを確認する)

### Ex.4 演算

1. [四則演算] x = 3, y = 4, z = 5として以下の値を求めなさい
    1. xとyとzの和
    1. xとyの和をzで割った値
    1. zのx乗
    1. zをxで割った商とあまり(整数除算)
1. [数学関数] x = c(1,2,3,4,5)として、以下を実行しなさい
    1. `sum(x)`
    1. `mean(x)`
    1. `var(x)`
    1. `sum((x - mean(x))^2) / 5`
1. [比較演算子] x=1, y=2として以下の計算を実行しなさい
    1. `x == y`
    1. `x != y`
    1. `x > y`
    1. `x < y`
    1. `x %in% c(2,4)`
    1. `y %in% c(2,4)`
1. [論理演算その１] x = c(T, T, F, F), y = c(T, F, T, F)として、以下を実行しなさい
    1. `x & y`
    1. `x && y`
    1. `x | y`
    1. `x || y`
    1. `!x`
1. [論理演算その２] x = c(T, T, T), y = c(T, T, F)として、以下を実行しなさい
    1. `all(x)`
    1. `all(y)`
    1. `any(x)`
    1. `any(y)`
1. [NAとの計算] 以下を実行しなさい
    1. `1 + NA`
    1. `0 * NA`
    1. `sum(1,2,NA)`
    1. `T & NA`
    1. `F & NA`
    1. `T | NA`
    1. `F | NA`

### Ex.5 ベクトル

1. [ベクトルの作成] 以下のベクトルを作成しなさい
    1. 1から5までの整数を順に並べたベクトル
    1. a,b,c,dのそれぞれの文字を要素とするベクトル
    1. コロン演算子`:`を使って、1から10までの整数を順に並べたベクトル
    1. コロン演算子`:`を使って、8から2までの整数を大きい順に並べたベクトル
    1. c(1,2,3)を4つ並べたベクトル
1. [ベクトル演算] x = 1:5, y = c(2,4), z=c(5, 3, 1)として、以下の計算をしなさい
    1. `x + 1`
    1. `y * 2`
    1. `x + y`
    1. `x * z`
    1. `sqrt(x)`
    1. `mean(y)`
    1. `rev(x)`
    1. `sort(z)`
1. [要素へのアクセス] x = c('a', 'b', 'c', 'd', 'e'), y = 1:6として、以下の操作をしなさい
    1. 添字番号を使ってxの3番目の要素を取り出す
    2. 整数ベクトルを使ってxの2番目と5番目の要素を取り出す
    3. xの1番目の要素をfに変更する
    4. 論理ベクトルを使ってxの1番目と4番目の要素を取り出す
    5. yの偶数である要素を取り出す
    6. yの2番目と3番目以外の要素を取り出す

### Ex.6 関数

1. [関数の作成]以下の関数を作成しなさい
    1. 実行すると'done.'と表示する関数
    1. 数値が入力されると、入力値の2倍足す1の値を返す関数
1. [制御構文]
    1. 以下の関数を作成しなさい。ただし整数以外の入力値については考慮しなくてよいものとする
        1. 入力された整数が偶数なら'even', 奇数なら'odd'と表示する関数
        1. 入力された整数を3で割った余りによって以下の表示をする関数
            + 余りが2ならば'two'
            + 余りが1ならば'one'
            + 余りが0ならば'zero'
    1. 前問(1)で作成した関数について、for文を使って1から20までの整数値を入力した結果を表示しなさい
    1. 入力された数字が3で割り切れるなら'fizz', 5で割り切れるなら'buzz', 3でも5でも割り切れるなら'fizzbuzz'を、
    それ以外は入力された数字を表示する関数を作成し、1から30までの整数までを入力した結果を表示しなさい
1. ★[forとベクトル] Sys.time()関数は現在時刻を取得できる関数である。
処理の終了時刻と開始時刻の差をとることで、処理の実行時間を計測できる。
```
start = Sys.time() # 開始時刻
# 実行時間を測りたい処理
end = Sys.time() # 終了時刻
result = end - start # 実行時間
```
+ Sys.time()関数を用いて以下のそれぞれの実行時間を計測し、比較しなさい
    1. 1から100,000までの整数の和をfor文を使って求める
    1. 1から100,000までの整数の和をsum()を使って求める


### Ex.7 データフレーム

1. [データフレームの操作] `excersise`フォルダに`ex7_1_a.tsv`-`ex7_1_d.tsv`が入っている（以下、ファイルA-Dと呼ぶ）。
これはある年における講義科目の学生の成績が入っている架空のデータである。学生は10人いて、社会学(sociology)と心理学(psychology)は必修であるため全員が受講し、
経済学(economics)と政治学(politics)は選択科目のため受講していない学生もいる。以下の問に答えなさい

    1. ファイルA-Dをデータフレームとして読み込みなさい(名前は`dfa`-`dfd`とすること)
    1. ファイルAはID1-ID5の学生の、ファイルBはID6-ID10の学生の社会学と心理学の成績である。rbind()関数を用いて両者を結合し、新しいデータフレームを作りなさい（名前は`df_ab`とすること）
    1. ファイルCは経済学、ファイルDは政治学の成績である。merge()関数を用いて以下の結合結果を確かめなさい。
        1. 経済学と政治学の両方を受講している学生のデータのみ使う
        1. 経済学を受講している学生のデータはすべて使い、政治学のみ受講している学生のデータは使わない
        1. 政治学を受講している学生のデータはすべて使い、経済学のみ受講している学生のデータは使わない
        1. ファイルC, ファイルDに含まれるすべての学生のデータを使う
    1. 前問(3-4)の結合結果を`df_cd`と呼ぶことにする。merge()関数を用いて、`df_ab`と`df_cd`を結合したデータフレームを作成しなさい(名前は`df_abcd`とする)。ただしすべてのデータを使う(all=T)こと
    1. `df_abcd`について、学生ひとりひとりの成績の平均値を求め、列名を`GPA`として新しい列を追加しなさい
    1. `df_abcd`をtsvファイルとして書き出しなさい


1. [データフレームと関数] `USJudgeRatings`は弁護士による米国高等裁判所における州裁判官の評価である。
    なお、各変数の説明は以下の通りである：
```
[,1]	CONT	Number of contacts of lawyer with judge. # 弁護士と裁判官の接触回数
[,2]	INTG	Judicial integrity. # 司法の廉潔性
[,3]	DMNR	Demeanor. # 態度
[,4]	DILG	Diligence. # 勤勉さ
[,5]	CFMG	Case flow managing. # 事案管理
[,6]	DECI	Prompt decisions. # 即決性
[,7]	PREP	Preparation for trial. # 審理への準備
[,8]	FAMI	Familiarity with law. # 法律への熟知性
[,9]	ORAL	Sound oral rulings. # 口頭決定の健全性
[,10]	WRIT	Sound written rulings. # 書面決定の健全性
[,11]	PHYS	Physical ability. # 身体能力
[,12]	RTEN	Worthy of retention. # 留保の適切さ
```

+ `USJudgeRatings`をデータセットとして以下の問に答えなさい
    1. psychパッケージをインストールしていないならば`install.packages('psych')`を実行し、インストールしなさい
    1. library()関数でpsychパッケージを読み込んだ上でdescribe()関数を適用し、要約統計量を算出しなさい
    1. データセットの行数と列数を求めなさい
    1. colMeans()を用いて、各変数について裁判官全体の平均値を求めなさい


### Ex.8 作図

1. [棒グラフと散布図] `USArrests`は1973年の米国における10万人当たりの暴力犯罪の件数および都市人口データである。
`USArrests`をデータセットとして用いて以下の問に答えなさい
    1. データセットの先頭5件を抽出し、殺人(Murder)の値を縦棒グラフで表示しなさい
    1. データセットの末尾5件を抽出し、暴行(Assault)の値を横棒グラフで表示しなさい
    1. plot()関数を用いて三種類の暴力犯罪(Murder, Assault, Rape)について、すべての組み合わせについて散布図を作成しなさい
    1. pairs()関数を用いてすべての変数についての散布図行列を作成しなさい
1. [時系列] `AirPassengers`は1949年から1960年にかけての月別国際航空旅客者数のデータである。
    1. plot()関数を用いて折れ線グラフを作りなさい
    1. png()関数を用いて(1)で作ったグラフを保存しなさい
1. [群間データ] `PlantGrowth`は植物の成長に関する実験データである。統制条件と２つの実験条件
の形三つの群(group)が用意され、植物の重量(weight)が測定された
    1. table()関数を用いて各条件の標本数を求めなさい
    1. 条件間を比較する箱ひげ図を作りなさい



### Ex.9 乱数

1. [sample()関数] 1から6の整数から均等な確率でひとつ数字を取り出す試行を繰り返すことを考える
（ただし数字の重複は許す）。sample()関数を使って均等な確率で1000回選び出し、以下の問に答えなさい（乱数なので答えは一定でない）
    1. 1が出た回数はいくつか
    1. 3以下の数字はいくつあるか
1. [runif()関数] runif()は0から1までの一様分布にしたがう乱数を出力できる関数である。
runif()関数を乱数を1000個生成し以下の問に答えなさい
    1. 0.2以下の数はいくつあるか
    1. 0.3以上、0.5以下の数はいくつあるか
1. ★[モンテカルロ・シミュレーション] runif()関数を使って近似的に円周率を求めたい
    1. runif()関数を用いて、$ 0 \leq x \leq 1, 0 \leq y \leq 1 $である点$(x, y)$ をランダムに1000個生成し、散布図にプロットしなさい
    1. 原点$(0,0)$からの距離が1以下である点の数を数えなさい。
    1. (1), (2)の結果から円周率の近似値を求めなさい。また、生成する点の数をを100,000にしたらどうなるか試しなさい
        + 考え方：ランダムに打たれた点のうち、原点$(0, 0)$を中心とする半径1の円の中にある点の数を$k$とする。
            + このとき正方形と扇部分の面積比は$n:k$に等しい
            + 正方形の面積は1である
            + 円の面積は$ \pi r^2$なので、扇部分の面積は$\frac{1}{4} \pi$である
            + $ 1 : \frac{1}{4} \pi  = n : k $の関係が成り立つので $ \pi = \frac{4k}{n}$


### Ex.10 dplyrによるデータハンドリング

1. `ToothGrowth`はビタミンCの用量と与え方がモルモットの歯の長さに与える影響を調べた実験データである。
これをデータセットとして用い、dplyrパッケージを読み込んだ上で以下の問に答えなさい
    1. パイプ演算子を使ってデータセットにhead()関数を適用しなさい
    1. パイプ演算子とfilter()関数を使って以下の操作をしなさい
        1. `supp`が`OJ`であった個体を抽出する
        1. `supp`が`VC`で、`dose`が2である個体を抽出する
        1. `supp`が`VC`である個体、または`dose`が2である個体を抽出する
    1. パイプ演算子とselect()関数を使って`len`列と`supp`列を抽出し、それぞれ「length」「supp_type」とリネームして表示しなさい
    1. パイプ演算子とarrange()関数を使って、`len`列で昇順にソートした結果を表示しなさい
    1. パイプ演算子とsummarize()関数を使って以下の操作をしなさい
        1. `len`の最大値・最小値・中央値・平均をそれぞれ求める
        1. group_byを`supp`列に適用し、群ごとの最大値・最小値・中央値・平均をそれぞれ求める


### Ex.11 stringrによる文字列操作

1. [基本操作] `month.name`は1年の月名のリストである。stringrを用いて以下の問に答えなさい
    1. str_subset()関数を用いて名前に'r'を含む月を抜き出しなさい
    1. str_detect()関数を用いて各月が名前に'r'を含むかどうかの論理ベクトルを得なさい
    1. str_length()関数を用いて各月の文字数を求めなさい
    1. str_subset()関数は正規表現を扱える。正規表現を用いて以下の条件にあてはまる月をそれぞれ求めなさい
        1. 名前が'A'で始まる月
        1. 名前が'r'で終わる月
        1. 名前の2文字目が'a'である月
        1. 名前の最後から3番目の文字が'u'である月
        1. 名前の最初の文字が母音である月
        1. 名前の最後の文字が'r'でも'y'でもない月
        1. 名前の末尾が'er'または'ry'で終わる月
    1. str_extract_all()関数は文字列の中から正規表現にマッチした部分をすべて抜き出せる。sentence='comuptational social science'として以下の要素を抜き出しなさい
        1. 単語(アルファベットの連続)
        1. 's'で始まる単語
        1. 'al'で終わる単語


